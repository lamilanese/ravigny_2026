<!DOCTYPE html>
<html lang="en">
<head>
  <link href="https://fonts.googleapis.com/css2?family=Eagle+Lake&display=swap" rel="stylesheet">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Scrolling Rotating Images with Cloud</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 600vh;
      font-family: Arial, sans-serif;
      overflow-x: hidden;
      overflow-y: scroll;
      overscroll-behavior-y: none;
      -webkit-overflow-scrolling: auto;
      color: rgb(30, 0, 57);
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: url('background.jpg') no-repeat center center;
      background-size: cover;
      z-index: -1;
    }

    /* --- ROTATING IMAGES --- */
    .images-container {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      pointer-events: none;
      z-index: 10;
    }

    .images-container img {
      position: absolute;
      top: 50%;
      left: 50%;
      height: 120vh;
      width: auto;
      transform: translate(-50%, -50%) rotate(0deg);
      transform-origin: center center;
    }

    .images-container img.img-medium {
      height: 30vh;
      width: auto;
    }

    /* --- CLOUD SECTION --- */
    #cloud-section {
      position: relative;
      height: 500vh;
    }

    .cloud-img {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%) scale(1);
      width: 140vw;
      height: auto;
      pointer-events: none;
      z-index: 4;
      opacity: 0.85;
      transition: opacity 0.2s linear;
    }

    .center-image {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      height: 15vh;
      width: auto;
      pointer-events: none;
      z-index: 20;
    }
    button {
      /* Size & spacing */
      min-height: 44px;
      padding: 12px 24px;
      margin: 8px 0;
      
      /* Typography */
      font-size: clamp(0.8rem, 2vw, 1.2rem);
      font-weight: 600;
      
      /* Visual styling */
      background: rgb(181, 0, 197); /* iOS blue */
      color: white;
      border: none;
      border-radius: 0px;
      
      /* Remove iOS defaults */
      -webkit-appearance: none;
      -webkit-tap-highlight-color: transparent;
      
      /* Smooth interactions */
      transition: all 0.2s ease;

      font-family: 'Eagle Lake', cursive;
      box-shadow: 
        0 0 20px rgba(181, 0, 197, 0.8),
        0 0 40px rgba(181, 0, 197, 0.2),
        0 0 60px rgba(181, 0, 197, 0.1);
    }

    button:hover {
      transform: scale(0.97);
      background: rgb(30, 0, 57);
      box-shadow: 
        0 0 20px rgba(30, 0, 57, 0.8),
        0 0 40px rgba(30, 0, 57, 0.2),
        0 0 60px rgba(30, 0, 57, 0.1);
      color: rgb(152, 150, 153);
    }

    .reveal-text {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: min(80vw, 80vh);
      text-align: left;
      font-family: 'Eagle Lake', cursive;
      font-size: clamp(0.8rem, 2vw, 1.2rem);
      opacity: 0;
      transition: opacity 0.2s linear;
      z-index: 30;
      text-shadow: 2px 2px 8px rgba(0,0,0,0.75);
    }

    .reveal-text button {
      margin-top: 20px;
      padding: 12px 24px;
      font-size: clamp(0.8rem, 2vw, 1.2rem);
      cursor: pointer;
    }

    /* --- FORM SECTION --- */
    #form-section {
      position: relative;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 30;
    }

    /* --- LOADING SCREEN --- */
    #loading-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }

    #loading-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .loading-dots {
      display: flex;
      gap: 10px;
    }

    .dot {
      width: 12px;
      height: 12px;
      background: white;
      border-radius: 50%;
      animation: bounce 1.4s infinite ease-in-out both;
    }

    .dot:nth-child(1) {
      animation-delay: -0.32s;
    }

    .dot:nth-child(2) {
      animation-delay: -0.16s;
    }

    @keyframes bounce {
      0%, 80%, 100% {
        transform: scale(0);
        opacity: 0.5;
      }
      40% {
        transform: scale(1);
        opacity: 1;
      }
    }

    .loading-text {
      margin-top: 20px;
      font-size: clamp(0.8rem, 2vw, 1.2rem);
      color: white;
      font-family: 'Eagle Lake', cursive;
    }


  </style>
</head>
<body>

  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-dots">
      <div class="dot"></div>
      <div class="dot"></div>
      <div class="dot"></div>
    </div>
    <div class="loading-text">Merci de patienter...</div>
  </div>

  <!-- Rotating images -->
  <div class="images-container">
    <img src="image1.png" id="img1" alt="Image 1">
    <img src="image2.png" id="img2" class="img-medium" alt="Image 2">
  </div>

  <!-- Cloud section -->
  <section id="cloud-section">
    <img src="clouds.png" id="cloud" class="cloud-img">
    <img src="center-image.png" id="centerImg" class="center-image">
    <div id="revealText" class="reveal-text">
      <p>Là-bas, au-delà des mirages tremblants, s’étendent des cités aux murs ocres, où minarets et coupoles 
        s’élancent vers le ciel comme des notes suspendues dans l’air parfumé de musc et de safran. 
        Les marchés bruissent de mille éclats de soie et de cuivre poli, tandis que les caravanes, 
        lentes et majestueuses, dessinent dans le sable des arabesques infinies. 
        Chaque recoin, chaque jardin d’orangers, chaque bassin miroitant semble sorti d’une toile de Gérôme ou d’un poème de 
        Flaubert : un monde où l’Orient, entre réalité et rêve, s’offre au regard comme une éternelle invitation au voyage. 
        Ô voyageur épris de beauté, abandonne-toi à cette vision, et laisse tes sens se perdre dans le frisson des parfums, 
        des couleurs et de l’éclat du soleil couchant sur les sables dorés...<br><br>
      
        Rejoignez-nous pour une deuxième édition du Charivari de Ravigny, les 28-29 juin 2026</p>
      <button id="scrollButton">Je confirme ma présence</button>
    </div>
  </section>

  <!-- Form section -->
  <section id="form-section">
    <form>
      <label for="name">Name:</label>
      <input type="text" id="name">
      <button type="submit">Submit</button>
    </form>
  </section>

  <script>
    const img1 = document.getElementById('img1');
    const img2 = document.getElementById('img2');
    const centerImg = document.getElementById('centerImg');
    const cloud = document.getElementById('cloud');
    const revealText = document.getElementById('revealText');
    const scrollButton = document.getElementById('scrollButton');
    const formSection = document.getElementById('form-section');
    const cloudSection = document.getElementById('cloud-section');
    const loadingScreen = document.getElementById('loading-screen');

    // Track loaded images
    let imagesToLoad = 4;
    let imagesLoaded = 0;

    function imageLoaded() {
      imagesLoaded++;
      if (imagesLoaded === imagesToLoad) {
        // All images loaded, hide loading screen
        setTimeout(() => {
          loadingScreen.classList.add('hidden');
        }, 300);
      }
    }

    // Set a maximum loading time (3 seconds)
    setTimeout(() => {
      if (!loadingScreen.classList.contains('hidden')) {
        loadingScreen.classList.add('hidden');
      }
    }, 3000);

    // Add load event listeners
    img1.addEventListener('load', imageLoaded);
    img2.addEventListener('load', imageLoaded);
    centerImg.addEventListener('load', imageLoaded);
    cloud.addEventListener('load', imageLoaded);

    // Handle errors (count as loaded to not block)
    img1.addEventListener('error', imageLoaded);
    img2.addEventListener('error', imageLoaded);
    centerImg.addEventListener('error', imageLoaded);
    cloud.addEventListener('error', imageLoaded);

    const imageParallaxFactor = 0.8;
    const rotationFactor = 0.08;
    
    const cloudTop = cloudSection.offsetTop;
    const cloudHeight = cloudSection.offsetHeight;

    // Define scroll milestones
    const imagesScrollOut = 800;
    const cloudZoomStart = imagesScrollOut + 100;
    const cloudZoomEnd = cloudZoomStart + 800;
    const textFadeInStart = cloudZoomEnd;
    const textFadeInEnd = textFadeInStart + 300;
    const textPauseEnd = textFadeInEnd + 600;
    const textFadeOutStart = textPauseEnd;
    const textFadeOutEnd = textFadeOutStart + 300;

    window.addEventListener('scroll', () => {
      const scrollY = window.scrollY;

      // Rotating images - move out of view
      const translateY = `calc(-50% - ${scrollY * imageParallaxFactor}px)`;
      const rotateDeg = scrollY * rotationFactor;

      img1.style.transform = `translate(-50%, ${translateY}) rotate(${rotateDeg}deg)`;
      img2.style.transform = `translate(-50%, ${translateY}) rotate(${-rotateDeg}deg)`;
      centerImg.style.transform = `translate(-50%, ${translateY})`;

      // Cloud zoom (starts after images scroll out)
      let cloudScale = 1;
      let cloudOpacity = 0.85;
      
      if (scrollY >= cloudZoomStart && scrollY <= cloudZoomEnd) {
        const cloudProgress = (scrollY - cloudZoomStart) / (cloudZoomEnd - cloudZoomStart);
        cloudScale = 1 + cloudProgress * 0.5;
        cloudOpacity = 0.85 - cloudProgress * 0.3;
      } else if (scrollY > cloudZoomEnd) {
        cloudScale = 1.5;
        cloudOpacity = 0.55;
      }
      
      cloud.style.transform = `translate(-50%, -50%) scale(${cloudScale})`;
      cloud.style.opacity = cloudOpacity;

      // Text: fade in -> pause -> fade out
      let textOpacity = 0;
      
      if (scrollY >= textFadeInStart && scrollY < textFadeInEnd) {
        textOpacity = (scrollY - textFadeInStart) / (textFadeInEnd - textFadeInStart);
      } else if (scrollY >= textFadeInEnd && scrollY <= textPauseEnd) {
        textOpacity = 1;
      } else if (scrollY > textPauseEnd && scrollY <= textFadeOutEnd) {
        textOpacity = 1 - (scrollY - textPauseEnd) / (textFadeOutEnd - textPauseEnd);
      }
      
      revealText.style.opacity = textOpacity;
    });

    // Smooth scroll to form
    scrollButton.addEventListener('click', () => {
      formSection.scrollIntoView({ behavior: 'smooth' });
    });

    // Trigger initial scroll update
    window.dispatchEvent(new Event('scroll'));
  </script>

</body>
</html>